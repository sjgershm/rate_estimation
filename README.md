Online Bayesian Rate Estimation Theory
====

Code for running Online Bayesian Rate Estimation Theory ([Gershman, 2024](https://osf.io/preprints/psyarxiv/47q5y)). See the rate_estimation notebook for a demo.

Questions? Contact Sam Gershman (gershman@fas.harvard.edu).

## The events function

We model an environment using an events function, which has the following syntax:
```
x, r = events(t)
```
where x is a stimulus vector (typically binary) and r is a reinforcement scalar (also typically binary).

The RET library comes with an events function generator that implements two different kinds of Pavlovian conditioning protocols. To implement a standard delay conditioning protocol, use the following syntax:
```
events = RET.generate_events_function(ISI,ITI)
```
where ISI is the interstimulus interval (in seconds) and ITI is the intertrial interval. Reinforcements will be generated in the last 100 ms of every stimulus.

If you additionally supply a third input,
```
events = RET.generate_events_function(ISI,ITI,lambda_vector)
```
the reinforcements will be sampled from a stimulus-dependent superposition of the components in lambda_vector. In particular, the reinforcements are generated by sampling from a Poisson process with a rate function:

$$\bar{r}(t) = \sum_i \lambda_i x_i(t)$$

## The model class

Rate Estimation Theory is implemented using a 'model' class, which can be initialized using the RET class constructor:
```
model = RET.model_constructor()
```
You can additionally pass specific parameters as input:
* nStim: number of stimuli (default: 2)
* n0: prior stimulus duration (default: 1)
* r0: prior number of reinforcements (default: 1)
* beta: decision threshold (default: 1)

For example:
```
model = RET.model_constructor(beta = 2)
```
The model class has the following methods:
* predict: estimated reinforcement rate for a stimulus vector. Example: ```model.predict(x)```
* CRprob: conditioned response probability for a stimulus vector. Example: ```model.CRprob(x)```
* informativeness: estimated informativeness (posterior mean H and variance V) for a stimulus vector. Example: ```H, V = model.informativeness(x)```
* run: execute the learning updates for an interval of time. Example: ```model.run(events, start_time, end_time)```

